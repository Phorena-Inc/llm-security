{
  "users": {
    "user123": {
      "name": "John Smith",
      "email": "john.smith@company.com",
      "location": "New York, NY, USA",
      "timezone": "America/New_York",
      "role": "analyst",
      "clearance_level": "confidential",
      "working_hours": {
        "start": "09:00",
        "end": "17:00",
        "days": ["monday", "tuesday", "wednesday", "thursday", "friday"]
      }
    },
    "user456": {
      "name": "Sarah Johnson",
      "email": "sarah.johnson@company.com",
      "location": "London, UK",
      "timezone": "Europe/London",
      "role": "operator",
      "clearance_level": "secret",
      "working_hours": {
        "start": "08:00",
        "end": "16:00",
        "days": ["monday", "tuesday", "wednesday", "thursday", "friday"]
      }
    },
    "user789": {
      "name": "Mike Chen",
      "email": "mike.chen@company.com",
      "location": "Tokyo, Japan",
      "timezone": "Asia/Tokyo",
      "role": "commander",
      "clearance_level": "confidential",
      "working_hours": {
        "start": "09:00",
        "end": "18:00",
        "days": ["monday", "tuesday", "wednesday", "thursday", "friday"]
      }
    }
  },
  "location_timezone_mapping": {
    "New York": "America/New_York",
    "London": "Europe/London",
    "Tokyo": "Asia/Tokyo",
    "Los Angeles": "America/Los_Angeles",
    "Paris": "Europe/Paris",
    "Sydney": "Australia/Sydney",
    "Mumbai": "Asia/Kolkata",
    "Dubai": "Asia/Dubai",
    "Singapore": "Asia/Singapore",
    "Berlin": "Europe/Berlin"
  },
  "timezone_policies": {
    "working_hours": {
      "description": "Standard access during working hours",
      "restrictions": {
        "confidential": "allow",
        "secret": "allow",
        "internal": "allow"
      }
    },
    "off_hours": {
      "description": "Restricted access outside working hours",
      "restrictions": {
        "confidential": "block",
        "secret": "block",
        "internal": "allow"
      }
    },
    "weekend": {
      "description": "Highly restricted access on weekends",
      "restrictions": {
        "confidential": "block",
        "secret": "block",
        "internal": "block"
      }
    },
    "emergency": {
      "description": "Emergency access overrides time restrictions",
      "restrictions": {
        "confidential": "allow",
        "secret": "allow",
        "internal": "allow"
      }
    }
  },
  "mission_phases": {
    "pre_deployment": {
      "description": "Pre-deployment phase with strict controls",
      "timezone_aware": true,
      "working_hours_only": true
    },
    "active_mission": {
      "description": "Active mission with operational access",
      "timezone_aware": true,
      "working_hours_only": false
    },
    "post_mission": {
      "description": "Post-mission analysis phase",
      "timezone_aware": true,
      "working_hours_only": true
    },
    "emergency": {
      "description": "Emergency phase overrides all restrictions",
      "timezone_aware": false,
      "working_hours_only": false
    }
  },
  "data_classifications": {
    "confidential": {
      "description": "Confidential data requiring special clearance",
      "level": "high",
      "examples": ["Project Zeus", "Classified Documents", "Mission Coordinates"],
      "timezone_restrictions": {
        "working_hours": "allow",
        "off_hours": "block",
        "weekend": "block"
      }
    },
    "secret": {
      "description": "Secret data with moderate restrictions",
      "level": "medium",
      "examples": ["Operation Alpha", "Tactical Plans", "Personnel Data"],
      "timezone_restrictions": {
        "working_hours": "allow",
        "off_hours": "block",
        "weekend": "block"
      }
    },
    "internal": {
      "description": "Internal data with minimal restrictions",
      "level": "low",
      "examples": ["General Reports", "Training Materials", "Public Information"],
      "timezone_restrictions": {
        "working_hours": "allow",
        "off_hours": "allow",
        "weekend": "block"
      }
    }
  },
  "test_scenarios": [
    {
      "scenario": "new_york_working_hours",
      "user_id": "user123",
      "user_name": "John Smith",
      "user_email": "john.smith@company.com",
      "location": "New York, NY, USA",
      "timezone": "America/New_York",
      "query": "What are the coordinates of Project Zeus?",
      "mission_phase": "pre_deployment",
      "current_time": "2024-01-15T14:30:00",
      "expected_result": "allowed",
      "expected_reason": "Access granted: user has clearance during working hours in America/New_York timezone"
    },
    {
      "scenario": "london_off_hours",
      "user_id": "user456",
      "user_name": "Sarah Johnson",
      "user_email": "sarah.johnson@company.com",
      "location": "London, UK",
      "timezone": "Europe/London",
      "query": "Show me the mission plans for Operation Alpha",
      "mission_phase": "pre_deployment",
      "current_time": "2024-01-15T20:30:00",
      "expected_result": "blocked",
      "expected_reason": "Access denied: off-hours restriction in Europe/London timezone"
    },
    {
      "scenario": "tokyo_weekend",
      "user_id": "user789",
      "user_name": "Mike Chen",
      "user_email": "mike.chen@company.com",
      "location": "Tokyo, Japan",
      "timezone": "Asia/Tokyo",
      "query": "Access confidential Project Zeus data",
      "mission_phase": "post_mission",
      "current_time": "2024-01-20T10:00:00",
      "expected_result": "blocked",
      "expected_reason": "Access denied: weekend restriction in Asia/Tokyo timezone"
    },
    {
      "scenario": "emergency_override",
      "user_id": "user123",
      "user_name": "John Smith",
      "user_email": "john.smith@company.com",
      "location": "New York, NY, USA",
      "timezone": "America/New_York",
      "query": "Emergency access to confidential data",
      "mission_phase": "emergency",
      "current_time": "2024-01-15T23:30:00",
      "expected_result": "allowed",
      "expected_reason": "Access granted: emergency phase overrides timezone restrictions"
    },
    {
      "scenario": "location_fallback",
      "user_id": "unknown_user",
      "user_name": "Unknown User",
      "user_email": "unknown@company.com",
      "location": "Los Angeles, CA, USA",
      "timezone": null,
      "query": "Show internal training materials",
      "mission_phase": "pre_deployment",
      "current_time": "2024-01-15T16:00:00",
      "expected_result": "allowed",
      "expected_reason": "Access granted: location-based timezone (America/Los_Angeles) during working hours"
    }
  ],
  "timezone_detection_rules": [
    "Include user email and name in policy decisions",
    "Look up timezone based on user location if not specified",
    "Apply timezone-aware restrictions based on user's local time",
    "Emergency phase overrides all timezone restrictions",
    "Working hours are defined per user's timezone"
  ],
  "firewall_rules": [
    {
      "name": "timezone_aware_access",
      "description": "Timezone-aware access control",
      "priority": 1,
      "conditions": [
        "user_has_valid_timezone",
        "mission_phase_requires_timezone_awareness",
        "not_emergency_phase"
      ],
      "actions": [
        "check_user_timezone",
        "determine_local_time",
        "apply_timezone_restrictions"
      ]
    },
    {
      "name": "emergency_override",
      "description": "Emergency phase override",
      "priority": 2,
      "conditions": [
        "emergency_phase_active"
      ],
      "actions": [
        "bypass_timezone_restrictions",
        "allow_access"
      ]
    },
    {
      "name": "location_fallback",
      "description": "Location-based timezone fallback",
      "priority": 3,
      "conditions": [
        "user_timezone_not_specified",
        "user_location_available"
      ],
      "actions": [
        "lookup_timezone_by_location",
        "apply_detected_timezone"
      ]
    }
  ]
} 